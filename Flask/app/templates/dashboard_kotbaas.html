<!doctype html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Kotbaas Dashboard</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/common.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/cards.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages.css') }}">
    
</head>

<body>

<header>
    <h1 style="margin:0;">Welkom terug, {{ naam }}</h1>
    <div class="auth-links">
        <a href="{{ url_for('logout') }}">Uitloggen</a>
    </div>
</header>

<div class="container">

    <!-- ROL SWITCHER -->
    {% if rollen|length > 1 %}
    <div class="switcher-box">
        <form method="post">
            <label><strong>Wissel dashboard:</strong>
                <select name="switch_rol" onchange="this.form.submit();">
                    {% for rolnaam in rollen %}
                        <option value="{{ rolnaam }}" {% if actieve_rol == rolnaam %}selected{% endif %}>
                            {{ rolnaam.title() }}
                        </option>
                    {% endfor %}
                </select>
            </label>
        </form>
    </div>
    {% endif %}

    <!-- KOT TOEVOEGEN -->
    <form action="{{ url_for('add_kot') }}" class="top-btn">
        <button type="submit" class="btn-primary">+ Voeg een kot toe</button>
    </form>

    <!-- VERHUURDE KOTEN -->
    <h2>Mijn verhuurde koten</h2>

    {% for kot in koten %}
        <div class="kot-card">
            <h3 style="margin-top:0;">{{ kot.adres }}, {{ kot.stad }}</h3>

            <p class="info-line">Oppervlakte: {{ kot.oppervlakte }} m²</p>
            <p class="info-line">Slaapplaatsen: {{ kot.aantal_slaapplaatsen }}</p>
            <p class="info-line">Prijs: <strong>€{{ kot.maandhuurprijs|format_currency }}/maand</strong></p>

            <p class="info-line">Student: {{ kot.student.gebruiker.naam if kot.student else "n.v.t." }}</p>
            <p class="info-line">Initiatiefnemer: {{ kot.initiatiefnemer }}</p>

            <form action="{{ url_for('verwijder_kot', kot_id=kot.kot_id) }}" method="post">
                <button class="btn-danger"
                onclick="return confirm('Weet je zeker dat je dit kot wilt verwijderen?');">
                Verwijder
                </button>
            </form>
        </div>
    {% else %}
        <p class="info-line">Je verhuurt nog geen koten.</p>
    {% endfor %}

    <!-- INBOX -->
    <h2>Inbox</h2>

    {% for kot in pending_koten %}
        <div class="inbox-card">
            <p><strong>Student:</strong> {{ kot.student.gebruiker.naam }}</p>
            <p><strong>Adres:</strong> {{ kot.adres }}</p>

            <form method="post" action="{{ url_for('approve_kot', kot_id=kot.kot_id) }}">
                <button class="btn-primary">Akkoord</button>
            </form>
        </div>
    {% else %}
        <p class="info-line">Je hebt geen verzoeken om te accorderen.</p>
    {% endfor %}

    <!-- CONTRACTEN TE ONDERTEKENEN -->
    <h2>Contracten te ondertekenen</h2>

    {% for contract in contracten_te_ondertekenen %}
        <div class="inbox-card">
            <p><strong>Kot:</strong> {{ contract.kot.adres }}, {{ contract.kot.stad }}</p>
            <p><strong>Student:</strong> {{ contract.student.gebruiker.naam }}</p>
            <!-- Download leeg Gitoo-contract -->
            <p>
                <a href="{{ url_for('static', filename='contracts/Gitoo_Verhuurcontract.pdf') }}"
                   class="btn-primary"
                   download>
                    Download leeg Gitoo‑contract
                </a>
            </p>
            <p class="info-line" style="margin-top:4px;">
                Download dit document, vul het in en onderteken het. Upload daarna de ondertekende versie hieronder.
            </p>

            <form method="post"
                  action="{{ url_for('contract_kotbaas', kot_id=contract.kot_id) }}"
                  enctype="multipart/form-data">
                <label>Upload ondertekend contract (PDF/afbeelding)</label><br>
                <input type="file" name="contract_file" accept=".pdf,.png,.jpg,.jpeg" required>
                <br><br>
                <button class="btn-primary">Upload contract</button>
            </form>
        </div>
    {% else %}
        <p class="info-line">Je hebt geen contracten te ondertekenen.</p>
    {% endfor %}    


    

</div>

</body>
</html>
