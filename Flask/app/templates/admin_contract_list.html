{% extends 'dashboard_admin.html' %}
{% block dashboard_content %}

<h2 style="color:#003b95; margin-top:0;">Contracten</h2>

<style>
    .filter-panel {
        margin-bottom: 20px;
        background: white;
        border-radius: 16px;
        padding: 16px;
        box-shadow: 0 15px 25px rgba(0,0,0,0.07);
        border: 1px solid rgba(0,59,149,0.08);
    }
    .filter-panel form {
        display: flex;
        gap: 12px;
        align-items: center;
        flex-wrap: wrap;
    }
    .filter-panel select {
        padding: 8px 12px;
        border-radius: 8px;
        border: 1px solid #cfd8ea;
    }
    .btn-primary {
        background-color: #0071c2;
        border: none;
        color: white;
        padding: 8px 14px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
    }
    .btn-primary:hover {
        background-color: #005999;
    }

    .table-scroll {
        width: 100%;
        overflow-x: auto;
        border-radius: 16px;
        padding-bottom: 8px;
    }
    .contract-table {
        width: 100%;
        min-width: 1000px;
        border-collapse: separate;
        border-spacing: 0;
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 25px 40px rgba(0,0,0,0.08);
        font-size: 0.92rem;
        border: 1px solid rgba(0,59,149,0.12);
    }
    .contract-table thead {
        background: linear-gradient(135deg, #f0f6ff, #dfe9ff);
    }
    .contract-table th,
    .contract-table td {
        padding: 12px 14px;
        border-bottom: 1px solid #e6e6e6;
    }
    .contract-table tr:last-child td {
        border-bottom: none;
    }
</style>

<div class="filter-panel">
    <form method="get" action="{{ url_for('dashboard_admin_contracten') }}">
        <label for="status"><strong>Status</strong></label>
        <select id="status" name="status">
            <option value="">Alle statussen</option>
            {% for s in ['wachten_op_kotbaas','wachten_op_student','compleet'] %}
                <option value="{{ s }}" {% if status_filter == s %}selected{% endif %}>
                    {{ s.replace('_', ' ') }}
                </option>
            {% endfor %}
        </select>
        <button type="submit" class="btn-primary">Toepassen</button>
    </form>
</div>

<div class="table-scroll">
<table class="contract-table">
    <thead>
        <tr>
            <th>Kot</th>
            <th>Kotbaas</th>
            <th>Student</th>
            <th>Status</th>
            <th>Kotbaas-contract</th>
            <th>Student-contract</th>
            <th>Aangemaakt op</th>
        </tr>
    </thead>
    <tbody>
        {% for contract in contracten %}
        <tr>
            <td>
                {{ contract.kot.adres if contract.kot else 'n.v.t.' }},
                {{ contract.kot.stad if contract.kot else '' }}
            </td>
            <td>
                {% if contract.kotbaas and contract.kotbaas.gebruiker %}
                    {{ contract.kotbaas.gebruiker.naam }}<br>
                    {{ contract.kotbaas.gebruiker.email }}
                {% else %}
                    n.v.t.
                {% endif %}
            </td>
            <td>
                {% if contract.student and contract.student.gebruiker %}
                    {{ contract.student.gebruiker.naam }}<br>
                    {{ contract.student.gebruiker.email }}
                {% else %}
                    n.v.t.
                {% endif %}
            </td>
            <td>{{ contract.status_contract.replace('_', ' ') }}</td>
            <td>
                {% if contract.pad_kotbaas %}
                    <a href="{{ contract.pad_kotbaas }}" target="_blank">Download</a>
                {% else %}
                    n.v.t.
                {% endif %}
            </td>
            <td>
                {% if contract.pad_student %}
                    <a href="{{ contract.pad_student }}" target="_blank">Download</a>
                {% else %}
                    n.v.t.
                {% endif %}
            </td>
            <td>{{ contract.aangemaakt_op.strftime('%Y-%m-%d %H:%M') if contract.aangemaakt_op else 'n.v.t.' }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="7" style="text-align:center; padding:20px;">
                Geen contracten gevonden.
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

{% endblock %}
