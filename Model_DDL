-- Table order and constraints may not be valid for execution.
-- SQL-script -> DDL

CREATE TABLE public.beschikbaarheid (
  beschikbaarheid_id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  kot_id integer,
  startdatum timestamp without time zone NOT NULL,
  einddatum timestamp without time zone NOT NULL,
  status_beschikbaarheid character varying CHECK (status_beschikbaarheid::text = ANY (ARRAY['beschikbaar'::character varying, 'bezet'::character varying, 'onder_optie'::character varying]::text[])),
  CONSTRAINT beschikbaarheid_pkey PRIMARY KEY (beschikbaarheid_id),
  CONSTRAINT beschikbaarheid_kot_id_fkey FOREIGN KEY (kot_id) REFERENCES public.kot(kot_id)
);

CREATE TABLE public.boeking (
  boeking_id integer NOT NULL DEFAULT nextval('boeking_boeking_id_seq'::regclass),
  gebruiker_id integer,
  kot_id integer,
  startdatum timestamp without time zone NOT NULL,
  einddatum timestamp without time zone NOT NULL,
  totaalprijs numeric,
  status_boeking character varying,
  aantal_personen integer NOT NULL DEFAULT 1,
  CONSTRAINT boeking_pkey PRIMARY KEY (boeking_id),
  CONSTRAINT boeking_gebruiker_id_fkey FOREIGN KEY (gebruiker_id) REFERENCES public.huurder(gebruiker_id),
  CONSTRAINT boeking_kot_id_fkey FOREIGN KEY (kot_id) REFERENCES public.kot(kot_id)
);

CREATE TABLE public.contract (
  contract_id integer NOT NULL DEFAULT nextval('contract_contract_id_seq'::regclass),
  kot_id integer NOT NULL UNIQUE,
  student_id integer NOT NULL,
  kotbaas_id integer NOT NULL,
  status_contract character varying NOT NULL,
  pad_contract_sjabloon character varying,
  pad_kotbaas character varying,
  pad_student character varying,
  aangemaakt_op timestamp without time zone,
  laatst_bijgewerkt_op timestamp without time zone,
  CONSTRAINT contract_pkey PRIMARY KEY (contract_id),
  CONSTRAINT contract_kot_id_fkey FOREIGN KEY (kot_id) REFERENCES public.kot(kot_id),
  CONSTRAINT contract_student_id_fkey FOREIGN KEY (student_id) REFERENCES public.student(gebruiker_id),
  CONSTRAINT contract_kotbaas_id_fkey FOREIGN KEY (kotbaas_id) REFERENCES public.kotbaas(gebruiker_id)
);

CREATE TABLE public.gebruiker (
  gebruiker_id integer NOT NULL DEFAULT nextval('gebruiker_gebruiker_id_seq'::regclass),
  naam character varying NOT NULL,
  email character varying NOT NULL UNIQUE,
  telefoon character varying,
  type character varying CHECK (type::text = ANY (ARRAY['student'::character varying, 'huurder'::character varying, 'kotbaas'::character varying]::text[])),
  aangemaakt_op timestamp without time zone DEFAULT now(),
  CONSTRAINT gebruiker_pkey PRIMARY KEY (gebruiker_id)
);

CREATE TABLE public.huurder (
  gebruiker_id integer NOT NULL,
  voorkeuren text DEFAULT ''::text,
  gesproken_taal character varying,
  CONSTRAINT huurder_pkey PRIMARY KEY (gebruiker_id),
  CONSTRAINT huurder_gebruiker_id_fkey FOREIGN KEY (gebruiker_id) REFERENCES public.gebruiker(gebruiker_id)
);

CREATE TABLE public.kot (
  kot_id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  student_id integer,
  adres character varying NOT NULL,
  stad character varying NOT NULL,
  oppervlakte integer,
  aantal_slaapplaatsen integer,
  maandhuurprijs real NOT NULL,
  brandveiligheidsconformiteit boolean DEFAULT true,
  eigen_keuken boolean DEFAULT false,
  eigen_sanitair boolean DEFAULT false,
  egwkosten real,
  goedgekeurd boolean DEFAULT false,
  foto text,
  kotbaas_id integer,
  initiatiefnemer character varying CHECK (initiatiefnemer::text = ANY (ARRAY['student'::text, 'kotbaas'::text])),
  beschrijving text,
  CONSTRAINT kot_pkey PRIMARY KEY (kot_id),
  CONSTRAINT kot_new_student_id_fkey FOREIGN KEY (student_id) REFERENCES public.student(gebruiker_id),
  CONSTRAINT kot_new_kotbaas_id_fkey FOREIGN KEY (kotbaas_id) REFERENCES public.kotbaas(gebruiker_id)
);

CREATE TABLE public.kotbaas (
  gebruiker_id integer NOT NULL,
  initiatiefnemer boolean DEFAULT false,
  CONSTRAINT kotbaas_pkey PRIMARY KEY (gebruiker_id),
  CONSTRAINT kotbaas_gebruiker_id_fkey FOREIGN KEY (gebruiker_id) REFERENCES public.gebruiker(gebruiker_id)
);

CREATE TABLE public.student (
  gebruiker_id integer NOT NULL,
  universiteit character varying,
  initiatiefnemer boolean DEFAULT false,
  CONSTRAINT student_pkey PRIMARY KEY (gebruiker_id),
  CONSTRAINT student_gebruiker_id_fkey FOREIGN KEY (gebruiker_id) REFERENCES public.gebruiker(gebruiker_id)
);
